options(scipen = 999)
library(ggplot2)
library(reshape2)
library(egg)
## Figure 2a chromosome lengths
chr_dat <- read.delim("C:/Users/HEN294/OneDrive - CSIRO/Documents/Research/Current_projects/Pca_pangenome/Pangenome_analysis/chr_test3.txt", sep = "\t", header = TRUE)
colnames(chr_dat) <- c("Haplotype", "1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18","mini")
chr_dat$Haplotype <- as.factor(chr_dat$Haplotype)
chr_dat$Haplotype <- factor(chr_dat$Haplotype, levels = c("hap1","hap2","hap3", "hap4", "hap5", "hap6", "hap7", "hap8", "hap9", "hap10", "hap11", "hap12", "hap13", "hap14", "hap15", "hap16", "hap17", "hap18", "hap19", "hap20","hap21","hap22","hap23","hap24","hap25","hap26","hap27","hap28","hap29","hap30","hap31","hap32","hap33","hap34","hap35","hap36","hap37","hap38","hap39","hap40","hap41","hap42","hap43","hap44","hap45","hap46","hap47","hap48","hap49","hap50","hap51","hap52"))
chr_melted <- melt(chr_dat, value.name = "Length")
colnames(chr_melted)[2] <- "Chr"
chr_melted$Length <- chr_melted$Length/1000000
ggplot(chr_melted) +
geom_boxplot(aes(x = Chr, y = Length), color = "grey60") +
geom_point(aes(x = Chr, y = Length), color = "black", size = 0.5) +
scale_y_continuous(expand = c(0.01,0.01)) +
labs(x = "Chromosome", y = "Length (Mbp)") +
theme(panel.background = element_blank(),
panel.grid = element_line(color = "grey90"),
axis.text = element_text(size = 8),
axis.title = element_text(size = 8))
chr_lengths_plot <- ggplot(chr_melted) +
geom_boxplot(aes(x = Chr, y = Length), color = "grey60") +
geom_point(aes(x = Chr, y = Length), color = "black", size = 0.5) +
scale_y_continuous(expand = c(0.01,0.01)) +
labs(x = "Chromosome", y = "Length (Mbp)") +
theme(panel.background = element_blank(),
panel.grid = element_line(color = "grey90"),
axis.text = element_text(size = 8),
axis.title = element_text(size = 8))
chr_lengths_plot
ggsave("C:/Users/HEN294/OneDrive - CSIRO/Documents/Research/Current_projects/Pca_pangenome/Pangenome_analysis/all_pangenome_chrlengths.tiff", chr_lengths_plot, device = "tiff", height = 4.5, width = 5, units = "in", dpi = 600)
ggsave("C:/Users/HEN294/OneDrive - CSIRO/Documents/Research/Current_projects/Pca_pangenome/Pangenome_analysis/all_pangenome_chrlengths.jpeg", chr_lengths_plot, device = "jpeg", height = 4.5, width = 5, units = "in", dpi = 600)
