geom_point(x = -50000, y = 1.5, color = "white") +
ggchicklet:::geom_rrect(data = chrlen_melt, aes(xmax = len, color = HAP, fill = HAP), xmin = 1, ymin = 0, ymax = 1, r = unit(0.3, 'npc')) +
geom_segment(aes(x = start, xend = end, color = REFHAP, group = HAP), y = 0.5, yend = 0.5, linewidth = 3.3, key_glyph = "pointrange") +
ggchicklet:::geom_rrect(data= chrlen_melt, aes(xmax = len+50000), xmin = -49999, ymin = -0.1, ymax = 1.1, r = unit(0.3, 'npc'), color = "white", fill = NA, size = 0.35) +
facet_grid(HAP ~ CHROM, labeller = labeller(CHROM = chr_labels), scales = "free_x", space = "free_x", switch = "y", margins = FALSE) +
scale_x_continuous(expand = c(0.01,0.01)) +
scale_y_discrete(limits=rev, expand = c(0.01,0.01)) +
scale_color_manual(breaks = c("hap3","hap4","hap25","hap26","hap5","hap7","hap8",
"hap27","hap28","hap29","hap30","hap31","hap32","hap14","hap1","hap2","hap13",
"hap11","hap15","hap16","hap17","hap18","hap19","hap20","hap6","hap10","hap12","hap23","hap9"),
values = c("#FA0348","#C581FC","grey20","#FA8203","#5EE3EF","grey20","grey20",
"grey20","grey20","grey20","grey20","grey20","grey20","#FF00F7","#0056FF","#006023","#FFCD97",
"#DDB8FF","#CFFFB8","#45C48C","#AEB431","#6BA9B4","grey20","grey20","grey20","grey20","grey20","grey20","grey20"),
name = "Color key", drop = TRUE, limits = c("hap3","hap4","hap26","hap5","hap14","hap1","hap2","hap13","hap11","hap15","hap16","hap17","hap18")) +
scale_fill_manual(breaks = c("hap3","hap4","hap25","hap26","hap5","hap7","hap8",
"hap27","hap28","hap29","hap30","hap31","hap32","hap14","hap1","hap2","hap13",
"hap11","hap15","hap16","hap17","hap18","hap19","hap20","hap6","hap10","hap12","hap23","hap9"),
values = c("#FA0348","#C581FC","grey20","#FA8203","#5EE3EF","grey20","grey20",
"grey20","grey20","grey20","grey20","grey20","grey20","#FF00F7","#0056FF","#006023","#FFCD97",
"#DDB8FF","#CFFFB8","#45C48C","#AEB431","#6BA9B4","grey20","grey20","grey20","grey20","grey20","grey20","grey20"),
name = "Color key", drop = TRUE, guide = "none") +
coord_cartesian(ylim = c(-0.6,1.6)) +
labs(x = NULL, y = NULL) +
theme(panel.background = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
strip.text.y.left = element_text(angle = 0, size = 10, hjust = 1),
strip.text.x.top = element_text(size = 10, vjust = 1, hjust = 0.5, margin = margin(t = 1, b = 0, l = 0, r = 0)),
strip.background.y = element_blank(),
axis.text.x = element_blank(),
legend.text = element_text(size = 8),
legend.title = element_blank(),
legend.key = element_blank(),
legend.key.size = unit(c(0.1), units = "in"),
plot.margin = unit(c(0,0,1.1,0), units = "lines"),
panel.spacing = unit(0, units = "lines"),
legend.position = c(0.4,-0.01),
legend.background = element_blank(),
legend.justification = "left",
strip.background.x = element_blank(),
axis.ticks.x = element_blank()) +
guides(color = guide_legend(nrow = 1, override.aes = list(size = 1, fill = NA, linetype = 0)))
plot <- ggplot(data = keepme, aes(y = HAP)) +
geom_point(aes(x = len+50000), y = -0.5, color = "white") +
geom_point(aes(x = len+50000), y = 1.5, color = "white") +
geom_point(x = -50000, y = -0.5, color = "white") +
geom_point(x = -50000, y = 1.5, color = "white") +
ggchicklet:::geom_rrect(data = chrlen_melt, aes(xmax = len, color = HAP, fill = HAP), xmin = 1, ymin = 0, ymax = 1, r = unit(0.3, 'npc')) +
geom_segment(aes(x = start, xend = end, color = REFHAP, group = HAP), y = 0.5, yend = 0.5, linewidth = 3.3, key_glyph = "pointrange") +
ggchicklet:::geom_rrect(data= chrlen_melt, aes(xmax = len+50000), xmin = -49999, ymin = -0.1, ymax = 1.1, r = unit(0.3, 'npc'), color = "white", fill = NA, size = 0.35) +
facet_grid(HAP ~ CHROM, labeller = labeller(CHROM = chr_labels), scales = "free_x", space = "free_x", switch = "y", margins = FALSE) +
scale_x_continuous(expand = c(0.01,0.01)) +
scale_y_discrete(limits=rev, expand = c(0.01,0.01)) +
scale_color_manual(breaks = c("hap3","hap4","hap25","hap26","hap5","hap7","hap8",
"hap27","hap28","hap29","hap30","hap31","hap32","hap14","hap1","hap2","hap13",
"hap11","hap15","hap16","hap17","hap18","hap19","hap20","hap6","hap10","hap12","hap23","hap9"),
values = c("#FA0348","#C581FC","grey20","#FA8203","#5EE3EF","grey20","grey20",
"grey20","grey20","grey20","grey20","grey20","grey20","#FF00F7","#0056FF","#006023","#FFCD97",
"#DDB8FF","#CFFFB8","#45C48C","#AEB431","#6BA9B4","grey20","grey20","grey20","grey20","grey20","grey20","grey20"),
name = "Color key", drop = TRUE, limits = c("hap3","hap4","hap26","hap5","hap14","hap1","hap2","hap13","hap11","hap15","hap16","hap17","hap18")) +
scale_fill_manual(breaks = c("hap3","hap4","hap25","hap26","hap5","hap7","hap8",
"hap27","hap28","hap29","hap30","hap31","hap32","hap14","hap1","hap2","hap13",
"hap11","hap15","hap16","hap17","hap18","hap19","hap20","hap6","hap10","hap12","hap23","hap9"),
values = c("#FA0348","#C581FC","grey20","#FA8203","#5EE3EF","grey20","grey20",
"grey20","grey20","grey20","grey20","grey20","grey20","#FF00F7","#0056FF","#006023","#FFCD97",
"#DDB8FF","#CFFFB8","#45C48C","#AEB431","#6BA9B4","grey20","grey20","grey20","grey20","grey20","grey20","grey20"),
name = "Color key", drop = TRUE, guide = "none") +
coord_cartesian(ylim = c(-0.6,1.6)) +
labs(x = NULL, y = NULL) +
theme(panel.background = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
strip.text.y.left = element_text(angle = 0, size = 10, hjust = 1),
strip.text.x.top = element_text(size = 10, vjust = 1, hjust = 0.5, margin = margin(t = 1, b = 0, l = 0, r = 0)),
strip.background.y = element_blank(),
axis.text.x = element_blank(),
legend.text = element_text(size = 8),
legend.title = element_blank(),
legend.key = element_blank(),
legend.key.size = unit(c(0.1), units = "in"),
plot.margin = unit(c(0,0,1.1,0), units = "lines"),
panel.spacing = unit(0, units = "lines"),
legend.position = c(0.4,-0.01),
legend.background = element_blank(),
legend.justification = "left",
strip.background.x = element_blank(),
axis.ticks.x = element_blank()) +
guides(color = guide_legend(nrow = 1, override.aes = list(size = 1, fill = NA, linetype = 0)))
ggsave("Supplemental_figure10_pangenome_blocks.tiff", plot, device = "tiff", width = 7, height = 9, units = "in", dpi = 600)
plot <- ggplot(data = keepme, aes(y = HAP)) +
geom_point(aes(x = len+50000), y = -0.5, color = "white") +
geom_point(aes(x = len+50000), y = 1.5, color = "white") +
geom_point(x = -50000, y = -0.5, color = "white") +
geom_point(x = -50000, y = 1.5, color = "white") +
ggchicklet:::geom_rrect(data = chrlen_melt, aes(xmax = len, fill = HAP), xmin = 1, ymin = 0, ymax = 1, r = unit(0.3, 'npc')) +
geom_segment(aes(x = start, xend = end, color = REFHAP, group = HAP), y = 0.5, yend = 0.5, linewidth = 3.3, key_glyph = "pointrange") +
ggchicklet:::geom_rrect(data= chrlen_melt, aes(xmax = len+50000), xmin = -49999, ymin = -0.1, ymax = 1.1, r = unit(0.3, 'npc'), color = "white", fill = NA, size = 0.35) +
facet_grid(HAP ~ CHROM, labeller = labeller(CHROM = chr_labels), scales = "free_x", space = "free_x", switch = "y", margins = FALSE) +
scale_x_continuous(expand = c(0.01,0.01)) +
scale_y_discrete(limits=rev, expand = c(0.01,0.01)) +
scale_color_manual(breaks = c("hap3","hap4","hap25","hap26","hap5","hap7","hap8",
"hap27","hap28","hap29","hap30","hap31","hap32","hap14","hap1","hap2","hap13",
"hap11","hap15","hap16","hap17","hap18","hap19","hap20","hap6","hap10","hap12","hap23","hap9"),
values = c("#FA0348","#C581FC","grey20","#FA8203","#5EE3EF","grey20","grey20",
"grey20","grey20","grey20","grey20","grey20","grey20","#FF00F7","#0056FF","#006023","#FFCD97",
"#DDB8FF","#CFFFB8","#45C48C","#AEB431","#6BA9B4","grey20","grey20","grey20","grey20","grey20","grey20","grey20"),
name = "Color key", drop = TRUE, limits = c("hap3","hap4","hap26","hap5","hap14","hap1","hap2","hap13","hap11","hap15","hap16","hap17","hap18")) +
scale_fill_manual(breaks = c("hap3","hap4","hap25","hap26","hap5","hap7","hap8",
"hap27","hap28","hap29","hap30","hap31","hap32","hap14","hap1","hap2","hap13",
"hap11","hap15","hap16","hap17","hap18","hap19","hap20","hap6","hap10","hap12","hap23","hap9"),
values = c("#FA0348","#C581FC","grey20","#FA8203","#5EE3EF","grey20","grey20",
"grey20","grey20","grey20","grey20","grey20","grey20","#FF00F7","#0056FF","#006023","#FFCD97",
"#DDB8FF","#CFFFB8","#45C48C","#AEB431","#6BA9B4","grey20","grey20","grey20","grey20","grey20","grey20","grey20"),
name = "Color key", drop = TRUE, guide = "none") +
coord_cartesian(ylim = c(-0.6,1.6)) +
labs(x = NULL, y = NULL) +
theme(panel.background = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
strip.text.y.left = element_text(angle = 0, size = 10, hjust = 1),
strip.text.x.top = element_text(size = 10, vjust = 1, hjust = 0.5, margin = margin(t = 1, b = 0, l = 0, r = 0)),
strip.background.y = element_blank(),
axis.text.x = element_blank(),
legend.text = element_text(size = 8),
legend.title = element_blank(),
legend.key = element_blank(),
legend.key.size = unit(c(0.1), units = "in"),
plot.margin = unit(c(0,0,1.1,0), units = "lines"),
panel.spacing = unit(0, units = "lines"),
legend.position = c(0.4,-0.01),
legend.background = element_blank(),
legend.justification = "left",
strip.background.x = element_blank(),
axis.ticks.x = element_blank()) +
guides(color = guide_legend(nrow = 1, override.aes = list(size = 1, fill = NA, linetype = 0)))
ggsave("Supplemental_figure10_pangenome_blocks.tiff", plot, device = "tiff", width = 7, height = 9, units = "in", dpi = 600)
plot <- ggplot(data = keepme, aes(y = HAP)) +
geom_point(aes(x = len+50000), y = -0.5, color = "white") +
geom_point(aes(x = len+50000), y = 1.5, color = "white") +
geom_point(x = -50000, y = -0.5, color = "white") +
geom_point(x = -50000, y = 1.5, color = "white") +
ggchicklet:::geom_rrect(data = chrlen_melt, aes(xmax = len, fill = HAP), xmin = 1, ymin = 0, ymax = 1, r = unit(0.3, 'npc')) +
geom_segment(aes(x = start, xend = end, color = REFHAP, group = HAP), y = 0.5, yend = 0.5, linewidth = 3.3, key_glyph = "pointrange") +
ggchicklet:::geom_rrect(data= chrlen_melt, aes(xmax = len+50000), xmin = -49999, ymin = -0.1, ymax = 1.1, r = unit(0.3, 'npc'), color = "white", fill = NA, size = 0.35) +
facet_grid(HAP ~ CHROM, labeller = labeller(CHROM = chr_labels), scales = "free_x", space = "free_x", switch = "y", margins = FALSE) +
scale_x_continuous(expand = c(0.01,0.01)) +
scale_y_discrete(limits=rev, expand = c(0.01,0.01)) +
scale_color_manual(breaks = c("hap3","hap4","hap25","hap26","hap5","hap7","hap8",
"hap27","hap28","hap29","hap30","hap31","hap32","hap14","hap1","hap2","hap13",
"hap11","hap15","hap16","hap17","hap18","hap19","hap20","hap6","hap10","hap12","hap23","hap9"),
values = c("#FA0348","#C581FC","grey20","#FA8203","#5EE3EF","grey20","grey20",
"grey20","grey20","grey20","grey20","grey20","grey20","#006023","#FF00F7","#0056FF","#FFCD97",
"#DDB8FF","#CFFFB8","#45C48C","#AEB431","#6BA9B4","grey20","grey20","grey20","grey20","grey20","grey20","grey20"),
name = "Color key", drop = TRUE, limits = c("hap3","hap4","hap26","hap5","hap14","hap1","hap2","hap13","hap11","hap15","hap16","hap17","hap18")) +
scale_fill_manual(breaks = c("hap3","hap4","hap25","hap26","hap5","hap7","hap8",
"hap27","hap28","hap29","hap30","hap31","hap32","hap14","hap1","hap2","hap13",
"hap11","hap15","hap16","hap17","hap18","hap19","hap20","hap6","hap10","hap12","hap23","hap9"),
values = c("#FA0348","#C581FC","grey20","#FA8203","#5EE3EF","grey20","grey20",
"grey20","grey20","grey20","grey20","grey20","grey20","#006023","#FF00F7","#0056FF","#FFCD97",
"#DDB8FF","#CFFFB8","#45C48C","#AEB431","#6BA9B4","grey20","grey20","grey20","grey20","grey20","grey20","grey20"),
name = "Color key", drop = TRUE, guide = "none") +
coord_cartesian(ylim = c(-0.6,1.6)) +
labs(x = NULL, y = NULL) +
theme(panel.background = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
strip.text.y.left = element_text(angle = 0, size = 10, hjust = 1),
strip.text.x.top = element_text(size = 10, vjust = 1, hjust = 0.5, margin = margin(t = 1, b = 0, l = 0, r = 0)),
strip.background.y = element_blank(),
axis.text.x = element_blank(),
legend.text = element_text(size = 8),
legend.title = element_blank(),
legend.key = element_blank(),
legend.key.size = unit(c(0.1), units = "in"),
plot.margin = unit(c(0,0,1.1,0), units = "lines"),
panel.spacing = unit(0, units = "lines"),
legend.position = c(0.1,-0.01),
legend.background = element_blank(),
legend.justification = "left",
strip.background.x = element_blank(),
axis.ticks.x = element_blank()) +
guides(color = guide_legend(nrow = 1, override.aes = list(size = 1, fill = NA, linetype = 0)))
ggsave("Supplemental_figure10_pangenome_blocks.tiff", plot, device = "tiff", width = 7, height = 9, units = "in", dpi = 600)
plot <- ggplot(data = keepme, aes(y = HAP)) +
geom_point(aes(x = len+50000), y = -0.5, color = "white") +
geom_point(aes(x = len+50000), y = 1.5, color = "white") +
geom_point(x = -50000, y = -0.5, color = "white") +
geom_point(x = -50000, y = 1.5, color = "white") +
ggchicklet:::geom_rrect(data = chrlen_melt, aes(xmax = len, fill = HAP), xmin = 1, ymin = 0, ymax = 1, r = unit(0.3, 'npc')) +
geom_segment(aes(x = start, xend = end, color = REFHAP, group = HAP), y = 0.5, yend = 0.5, linewidth = 3.7, key_glyph = "pointrange") +
ggchicklet:::geom_rrect(data= chrlen_melt, aes(xmax = len+50000), xmin = -49999, ymin = -0.1, ymax = 1.1, r = unit(0.3, 'npc'), color = "white", fill = NA, size = 0.35) +
facet_grid(HAP ~ CHROM, labeller = labeller(CHROM = chr_labels), scales = "free_x", space = "free_x", switch = "y", margins = FALSE) +
scale_x_continuous(expand = c(0.01,0.01)) +
scale_y_discrete(limits=rev, expand = c(0.01,0.01)) +
scale_color_manual(breaks = c("hap3","hap4","hap25","hap26","hap5","hap7","hap8",
"hap27","hap28","hap29","hap30","hap31","hap32","hap14","hap1","hap2","hap13",
"hap11","hap15","hap16","hap17","hap18","hap19","hap20","hap6","hap10","hap12","hap23","hap9"),
values = c("#FA0348","#C581FC","grey20","#FA8203","#5EE3EF","grey20","grey20",
"grey20","grey20","grey20","grey20","grey20","grey20","#006023","#FF00F7","#0056FF","#FFCD97",
"#DDB8FF","#CFFFB8","#45C48C","#AEB431","#6BA9B4","grey20","grey20","grey20","grey20","grey20","grey20","grey20"),
name = "Color key", drop = TRUE, limits = c("hap3","hap4","hap26","hap5","hap14","hap1","hap2","hap13","hap11","hap15","hap16","hap17","hap18")) +
scale_fill_manual(breaks = c("hap3","hap4","hap25","hap26","hap5","hap7","hap8",
"hap27","hap28","hap29","hap30","hap31","hap32","hap14","hap1","hap2","hap13",
"hap11","hap15","hap16","hap17","hap18","hap19","hap20","hap6","hap10","hap12","hap23","hap9"),
values = c("#FA0348","#C581FC","grey20","#FA8203","#5EE3EF","grey20","grey20",
"grey20","grey20","grey20","grey20","grey20","grey20","#006023","#FF00F7","#0056FF","#FFCD97",
"#DDB8FF","#CFFFB8","#45C48C","#AEB431","#6BA9B4","grey20","grey20","grey20","grey20","grey20","grey20","grey20"),
name = "Color key", drop = TRUE, guide = "none") +
coord_cartesian(ylim = c(-0.6,1.6)) +
labs(x = NULL, y = NULL) +
theme(panel.background = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
strip.text.y.left = element_text(angle = 0, size = 10, hjust = 1),
strip.text.x.top = element_text(size = 10, vjust = 1, hjust = 0.5, margin = margin(t = 1, b = 0, l = 0, r = 0)),
strip.background.y = element_blank(),
axis.text.x = element_blank(),
legend.text = element_text(size = 8),
legend.title = element_blank(),
legend.key = element_blank(),
legend.key.size = unit(c(0.1), units = "in"),
plot.margin = unit(c(0,0,1.1,0), units = "lines"),
panel.spacing = unit(0, units = "lines"),
legend.position = c(0.03,-0.01),
legend.background = element_blank(),
legend.justification = "left",
strip.background.x = element_blank(),
axis.ticks.x = element_blank()) +
guides(color = guide_legend(nrow = 1, override.aes = list(size = 1, fill = NA, linetype = 0)))
ggsave("Supplemental_figure10_pangenome_blocks.tiff", plot, device = "tiff", width = 7, height = 9, units = "in", dpi = 600)
plot <- ggplot(data = keepme, aes(y = HAP)) +
geom_point(aes(x = len+50000), y = -0.5, color = "white") +
geom_point(aes(x = len+50000), y = 1.5, color = "white") +
geom_point(x = -50000, y = -0.5, color = "white") +
geom_point(x = -50000, y = 1.5, color = "white") +
ggchicklet:::geom_rrect(data = chrlen_melt, aes(xmax = len, fill = HAP), xmin = 1, ymin = 0, ymax = 1, r = unit(0.3, 'npc')) +
geom_segment(aes(x = start, xend = end, color = REFHAP, group = HAP), y = 0.5, yend = 0.5, linewidth = 3.8, key_glyph = "pointrange") +
ggchicklet:::geom_rrect(data= chrlen_melt, aes(xmax = len+50000), xmin = -49999, ymin = -0.1, ymax = 1.1, r = unit(0.3, 'npc'), color = "white", fill = NA, size = 0.35) +
facet_grid(HAP ~ CHROM, labeller = labeller(CHROM = chr_labels), scales = "free_x", space = "free_x", switch = "y", margins = FALSE) +
scale_x_continuous(expand = c(0.01,0.01)) +
scale_y_discrete(limits=rev, expand = c(0.01,0.01)) +
scale_color_manual(breaks = c("hap3","hap4","hap25","hap26","hap5","hap7","hap8",
"hap27","hap28","hap29","hap30","hap31","hap32","hap14","hap1","hap2","hap13",
"hap11","hap15","hap16","hap17","hap18","hap19","hap20","hap6","hap10","hap12","hap23","hap9"),
values = c("#FA0348","#C581FC","grey20","#FA8203","#5EE3EF","grey20","grey20",
"grey20","grey20","grey20","grey20","grey20","grey20","#006023","#FF00F7","#0056FF","#FFCD97",
"#DDB8FF","#CFFFB8","#45C48C","#AEB431","#6BA9B4","grey20","grey20","grey20","grey20","grey20","grey20","grey20"),
name = "Color key", drop = TRUE, limits = c("hap3","hap4","hap26","hap5","hap14","hap1","hap2","hap13","hap11","hap15","hap16","hap17","hap18")) +
scale_fill_manual(breaks = c("hap3","hap4","hap25","hap26","hap5","hap7","hap8",
"hap27","hap28","hap29","hap30","hap31","hap32","hap14","hap1","hap2","hap13",
"hap11","hap15","hap16","hap17","hap18","hap19","hap20","hap6","hap10","hap12","hap23","hap9"),
values = c("#FA0348","#C581FC","grey20","#FA8203","#5EE3EF","grey20","grey20",
"grey20","grey20","grey20","grey20","grey20","grey20","#006023","#FF00F7","#0056FF","#FFCD97",
"#DDB8FF","#CFFFB8","#45C48C","#AEB431","#6BA9B4","grey20","grey20","grey20","grey20","grey20","grey20","grey20"),
name = "Color key", drop = TRUE, guide = "none") +
coord_cartesian(ylim = c(-0.6,1.6)) +
labs(x = NULL, y = NULL) +
theme(panel.background = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
strip.text.y.left = element_text(angle = 0, size = 10, hjust = 1),
strip.text.x.top = element_text(size = 10, vjust = 1, hjust = 0.5, margin = margin(t = 1, b = 0, l = 0, r = 0)),
strip.background.y = element_blank(),
axis.text.x = element_blank(),
legend.text = element_text(size = 8),
legend.title = element_blank(),
legend.key = element_blank(),
legend.key.size = unit(c(0.1), units = "in"),
plot.margin = unit(c(0,0,1.1,0), units = "lines"),
panel.spacing = unit(0, units = "lines"),
legend.position = c(0.01,-0.01),
legend.background = element_blank(),
legend.justification = "left",
strip.background.x = element_blank(),
axis.ticks.x = element_blank()) +
guides(color = guide_legend(nrow = 1, override.aes = list(size = 1, fill = NA, linetype = 0)))
ggsave("Supplemental_figure10_pangenome_blocks.tiff", plot, device = "tiff", width = 7, height = 9, units = "in", dpi = 600)
plot <- ggplot(data = keepme, aes(y = HAP)) +
geom_point(aes(x = len+50000), y = -0.5, color = "white") +
geom_point(aes(x = len+50000), y = 1.5, color = "white") +
geom_point(x = -50000, y = -0.5, color = "white") +
geom_point(x = -50000, y = 1.5, color = "white") +
ggchicklet:::geom_rrect(data = chrlen_melt, aes(xmax = len, fill = HAP), xmin = 1, ymin = 0, ymax = 1, r = unit(0.3, 'npc')) +
geom_segment(aes(x = start, xend = end, color = REFHAP, group = HAP), y = 0.5, yend = 0.5, linewidth = 3.7, key_glyph = "pointrange") +
ggchicklet:::geom_rrect(data= chrlen_melt, aes(xmax = len+50000), xmin = -49999, ymin = -0.1, ymax = 1.1, r = unit(0.3, 'npc'), color = "white", fill = NA, size = 0.35) +
facet_grid(HAP ~ CHROM, labeller = labeller(CHROM = chr_labels), scales = "free_x", space = "free_x", switch = "y", margins = FALSE) +
scale_x_continuous(expand = c(0.01,0.01)) +
scale_y_discrete(limits=rev, expand = c(0.01,0.01)) +
scale_color_manual(breaks = c("hap3","hap4","hap25","hap26","hap5","hap7","hap8",
"hap27","hap28","hap29","hap30","hap31","hap32","hap14","hap1","hap2","hap13",
"hap11","hap15","hap16","hap17","hap18","hap19","hap20","hap6","hap10","hap12","hap23","hap9"),
values = c("#FA0348","#C581FC","grey20","#FA8203","#5EE3EF","grey20","grey20",
"grey20","grey20","grey20","grey20","grey20","grey20","#006023","#FF00F7","#0056FF","#FFCD97",
"#DDB8FF","#CFFFB8","#45C48C","#AEB431","#6BA9B4","grey20","grey20","grey20","grey20","grey20","grey20","grey20"),
name = "Color key", drop = TRUE, limits = c("hap3","hap4","hap26","hap5","hap14","hap1","hap2","hap13","hap11","hap15","hap16","hap17","hap18")) +
scale_fill_manual(breaks = c("hap3","hap4","hap25","hap26","hap5","hap7","hap8",
"hap27","hap28","hap29","hap30","hap31","hap32","hap14","hap1","hap2","hap13",
"hap11","hap15","hap16","hap17","hap18","hap19","hap20","hap6","hap10","hap12","hap23","hap9"),
values = c("#FA0348","#C581FC","grey20","#FA8203","#5EE3EF","grey20","grey20",
"grey20","grey20","grey20","grey20","grey20","grey20","#006023","#FF00F7","#0056FF","#FFCD97",
"#DDB8FF","#CFFFB8","#45C48C","#AEB431","#6BA9B4","grey20","grey20","grey20","grey20","grey20","grey20","grey20"),
name = "Color key", drop = TRUE, guide = "none") +
coord_cartesian(ylim = c(-0.6,1.6)) +
labs(x = NULL, y = NULL) +
theme(panel.background = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
strip.text.y.left = element_text(angle = 0, size = 10, hjust = 1),
strip.text.x.top = element_text(size = 10, vjust = 1, hjust = 0.5, margin = margin(t = 1, b = 0, l = 0, r = 0)),
strip.background.y = element_blank(),
axis.text.x = element_blank(),
legend.text = element_text(size = 8),
legend.title = element_blank(),
legend.key = element_blank(),
legend.key.size = unit(c(0.1), units = "in"),
plot.margin = unit(c(0,0,1.1,0), units = "lines"),
panel.spacing = unit(0, units = "lines"),
legend.position = c(0.001,-0.01),
legend.background = element_blank(),
legend.justification = "left",
strip.background.x = element_blank(),
axis.ticks.x = element_blank()) +
guides(color = guide_legend(nrow = 1, override.aes = list(size = 1, fill = NA, linetype = 0)))
ggsave("Supplemental_figure10_pangenome_blocks.tiff", plot, device = "tiff", width = 7, height = 9, units = "in", dpi = 600)
plot <- ggplot(data = keepme, aes(y = HAP)) +
geom_point(aes(x = len+50000), y = -0.5, color = "white") +
geom_point(aes(x = len+50000), y = 1.5, color = "white") +
geom_point(x = -50000, y = -0.5, color = "white") +
geom_point(x = -50000, y = 1.5, color = "white") +
ggchicklet:::geom_rrect(data = chrlen_melt, aes(xmax = len, fill = HAP), xmin = 1, ymin = 0, ymax = 1, r = unit(0.3, 'npc')) +
geom_segment(aes(x = start, xend = end, color = REFHAP, group = HAP), y = 0.5, yend = 0.5, linewidth = 3.7, key_glyph = "pointrange") +
ggchicklet:::geom_rrect(data= chrlen_melt, aes(xmax = len+50000), xmin = -49999, ymin = -0.1, ymax = 1.1, r = unit(0.3, 'npc'), color = "white", fill = NA, size = 0.35) +
facet_grid(HAP ~ CHROM, labeller = labeller(CHROM = chr_labels), scales = "free_x", space = "free_x", switch = "y", margins = FALSE) +
scale_x_continuous(expand = c(0.01,0.01)) +
scale_y_discrete(limits=rev, expand = c(0.01,0.01)) +
scale_color_manual(breaks = c("hap3","hap4","hap25","hap26","hap5","hap7","hap8",
"hap27","hap28","hap29","hap30","hap31","hap32","hap14","hap1","hap2","hap13",
"hap11","hap15","hap16","hap17","hap18","hap19","hap20","hap6","hap10","hap12","hap23","hap9"),
values = c("#FA0348","#C581FC","grey20","#FA8203","#5EE3EF","grey20","grey20",
"grey20","grey20","grey20","grey20","grey20","grey20","#006023","#FF00F7","#0056FF","#FFCD97",
"#DDB8FF","#CFFFB8","#45C48C","#AEB431","#6BA9B4","grey20","grey20","grey20","grey20","grey20","grey20","grey20"),
name = "Color key", drop = TRUE, limits = c("hap3","hap4","hap26","hap5","hap14","hap1","hap2","hap13","hap11","hap15","hap16","hap17","hap18")) +
scale_fill_manual(breaks = c("hap3","hap4","hap25","hap26","hap5","hap7","hap8",
"hap27","hap28","hap29","hap30","hap31","hap32","hap14","hap1","hap2","hap13",
"hap11","hap15","hap16","hap17","hap18","hap19","hap20","hap6","hap10","hap12","hap23","hap9"),
values = c("#FA0348","#C581FC","grey20","#FA8203","#5EE3EF","grey20","grey20",
"grey20","grey20","grey20","grey20","grey20","grey20","#006023","#FF00F7","#0056FF","#FFCD97",
"#DDB8FF","#CFFFB8","#45C48C","#AEB431","#6BA9B4","grey20","grey20","grey20","grey20","grey20","grey20","grey20"),
name = "Color key", drop = TRUE, guide = "none") +
coord_cartesian(ylim = c(-0.6,1.6)) +
labs(x = NULL, y = NULL) +
theme(panel.background = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
strip.text.y.left = element_text(angle = 0, size = 10, hjust = 1),
strip.text.x.top = element_text(size = 10, vjust = 1, hjust = 0.5, margin = margin(t = 1, b = 0, l = 0, r = 0)),
strip.background.y = element_blank(),
axis.text.x = element_blank(),
legend.text = element_text(size = 8),
legend.title = element_blank(),
legend.key = element_blank(),
legend.key.size = unit(c(0.1), units = "in"),
plot.margin = unit(c(0,0,1.1,0), units = "lines"),
panel.spacing = unit(0, units = "lines"),
legend.position = c(-0.04,-0.01),
legend.background = element_blank(),
legend.justification = "left",
strip.background.x = element_blank(),
axis.ticks.x = element_blank()) +
guides(color = guide_legend(nrow = 1, override.aes = list(size = 1, fill = NA, linetype = 0)))
ggsave("Supplemental_figure10_pangenome_blocks.tiff", plot, device = "tiff", width = 7, height = 9, units = "in", dpi = 600)
plot <- ggplot(data = keepme, aes(y = HAP)) +
geom_point(aes(x = len+50000), y = -0.5, color = "white") +
geom_point(aes(x = len+50000), y = 1.5, color = "white") +
geom_point(x = -50000, y = -0.5, color = "white") +
geom_point(x = -50000, y = 1.5, color = "white") +
ggchicklet:::geom_rrect(data = chrlen_melt, aes(xmax = len, fill = HAP), xmin = 1, ymin = 0, ymax = 1, r = unit(0.3, 'npc')) +
geom_segment(aes(x = start, xend = end, color = REFHAP, group = HAP), y = 0.5, yend = 0.5, linewidth = 3.7, key_glyph = "pointrange") +
ggchicklet:::geom_rrect(data= chrlen_melt, aes(xmax = len+50000), xmin = -49999, ymin = -0.1, ymax = 1.1, r = unit(0.3, 'npc'), color = "white", fill = NA, size = 0.35) +
facet_grid(HAP ~ CHROM, labeller = labeller(CHROM = chr_labels), scales = "free_x", space = "free_x", switch = "y", margins = FALSE) +
scale_x_continuous(expand = c(0.01,0.01)) +
scale_y_discrete(limits=rev, expand = c(0.01,0.01)) +
scale_color_manual(breaks = c("hap3","hap4","hap25","hap26","hap5","hap7","hap8",
"hap27","hap28","hap29","hap30","hap31","hap32","hap14","hap1","hap2","hap13",
"hap11","hap15","hap16","hap17","hap18","hap19","hap20","hap6","hap10","hap12","hap23","hap9"),
values = c("#FA0348","#C581FC","grey20","#FA8203","#5EE3EF","grey20","grey20",
"grey20","grey20","grey20","grey20","grey20","grey20","#006023","#FF00F7","#0056FF","#FFCD97",
"#DDB8FF","#CFFFB8","#45C48C","#AEB431","#6BA9B4","grey20","grey20","grey20","grey20","grey20","grey20","grey20"),
name = "Color key", drop = TRUE, limits = c("hap3","hap4","hap26","hap5","hap14","hap1","hap2","hap13","hap11","hap15","hap16","hap17","hap18")) +
scale_fill_manual(breaks = c("hap3","hap4","hap25","hap26","hap5","hap7","hap8",
"hap27","hap28","hap29","hap30","hap31","hap32","hap14","hap1","hap2","hap13",
"hap11","hap15","hap16","hap17","hap18","hap19","hap20","hap6","hap10","hap12","hap23","hap9"),
values = c("#FA0348","#C581FC","grey20","#FA8203","#5EE3EF","grey20","grey20",
"grey20","grey20","grey20","grey20","grey20","grey20","#006023","#FF00F7","#0056FF","#FFCD97",
"#DDB8FF","#CFFFB8","#45C48C","#AEB431","#6BA9B4","grey20","grey20","grey20","grey20","grey20","grey20","grey20"),
name = "Color key", drop = TRUE, guide = "none") +
coord_cartesian(ylim = c(-0.6,1.6)) +
labs(x = NULL, y = NULL) +
theme(panel.background = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
strip.text.y.left = element_text(angle = 0, size = 10, hjust = 1),
strip.text.x.top = element_text(size = 10, vjust = 1, hjust = 0.5, margin = margin(t = 1, b = 0, l = 0, r = 0)),
strip.background.y = element_blank(),
axis.text.x = element_blank(),
legend.text = element_text(size = 8),
legend.title = element_blank(),
legend.key = element_blank(),
legend.key.size = unit(c(0.1), units = "in"),
plot.margin = unit(c(0,0,1.1,0), units = "lines"),
panel.spacing = unit(0, units = "lines"),
legend.position = c(-0.06,-0.01),
legend.background = element_blank(),
legend.justification = "left",
strip.background.x = element_blank(),
axis.ticks.x = element_blank()) +
guides(color = guide_legend(nrow = 1, override.aes = list(size = 1, fill = NA, linetype = 0)))
ggsave("Supplemental_figure10_pangenome_blocks.tiff", plot, device = "tiff", width = 7, height = 9, units = "in", dpi = 600)
plot <- ggplot(data = keepme, aes(y = HAP)) +
geom_point(aes(x = len+50000), y = -0.5, color = "white") +
geom_point(aes(x = len+50000), y = 1.5, color = "white") +
geom_point(x = -50000, y = -0.5, color = "white") +
geom_point(x = -50000, y = 1.5, color = "white") +
ggchicklet:::geom_rrect(data = chrlen_melt, aes(xmax = len, fill = HAP), xmin = 1, ymin = 0, ymax = 1, r = unit(0.3, 'npc')) +
geom_segment(aes(x = start, xend = end, color = REFHAP, group = HAP), y = 0.5, yend = 0.5, linewidth = 3.7, key_glyph = "pointrange") +
ggchicklet:::geom_rrect(data= chrlen_melt, aes(xmax = len+50000), xmin = -49999, ymin = -0.1, ymax = 1.1, r = unit(0.3, 'npc'), color = "white", fill = NA, size = 0.35) +
facet_grid(HAP ~ CHROM, labeller = labeller(CHROM = chr_labels), scales = "free_x", space = "free_x", switch = "y", margins = FALSE) +
scale_x_continuous(expand = c(0.01,0.01)) +
scale_y_discrete(limits=rev, expand = c(0.01,0.01)) +
scale_color_manual(breaks = c("hap3","hap4","hap25","hap26","hap5","hap7","hap8",
"hap27","hap28","hap29","hap30","hap31","hap32","hap14","hap1","hap2","hap13",
"hap11","hap15","hap16","hap17","hap18","hap19","hap20","hap6","hap10","hap12","hap23","hap9"),
values = c("#FA0348","#C581FC","grey20","#FA8203","#5EE3EF","grey20","grey20",
"grey20","grey20","grey20","grey20","grey20","grey20","#006023","#FF00F7","#0056FF","#FFCD97",
"#DDB8FF","#CFFFB8","#45C48C","#AEB431","#6BA9B4","grey20","grey20","grey20","grey20","grey20","grey20","grey20"),
name = "Color key", drop = TRUE, limits = c("hap3","hap4","hap26","hap5","hap14","hap1","hap2","hap13","hap11","hap15","hap16","hap17","hap18")) +
scale_fill_manual(breaks = c("hap3","hap4","hap25","hap26","hap5","hap7","hap8",
"hap27","hap28","hap29","hap30","hap31","hap32","hap14","hap1","hap2","hap13",
"hap11","hap15","hap16","hap17","hap18","hap19","hap20","hap6","hap10","hap12","hap23","hap9"),
values = c("#FA0348","#C581FC","grey20","#FA8203","#5EE3EF","grey20","grey20",
"grey20","grey20","grey20","grey20","grey20","grey20","#006023","#FF00F7","#0056FF","#FFCD97",
"#DDB8FF","#CFFFB8","#45C48C","#AEB431","#6BA9B4","grey20","grey20","grey20","grey20","grey20","grey20","grey20"),
name = "Color key", drop = TRUE, guide = "none") +
coord_cartesian(ylim = c(-0.6,1.6)) +
labs(x = NULL, y = NULL) +
theme(panel.background = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
strip.text.y.left = element_text(angle = 0, size = 10, hjust = 1),
strip.text.x.top = element_text(size = 10, vjust = 1, hjust = 0.5, margin = margin(t = 1, b = 0, l = 0, r = 0)),
strip.background.y = element_blank(),
axis.text.x = element_blank(),
legend.text = element_text(size = 8),
legend.title = element_blank(),
legend.key = element_blank(),
legend.key.size = unit(c(0.1), units = "in"),
plot.margin = unit(c(0,0,1.1,0), units = "lines"),
panel.spacing = unit(0, units = "lines"),
legend.position = c(-0.08,-0.01),
legend.background = element_blank(),
legend.justification = "left",
strip.background.x = element_blank(),
axis.ticks.x = element_blank()) +
guides(color = guide_legend(nrow = 1, override.aes = list(size = 1, fill = NA, linetype = 0)))
ggsave("Supplemental_figure10_pangenome_blocks.tiff", plot, device = "tiff", width = 7, height = 9, units = "in", dpi = 600)
plot <- ggplot(data = keepme, aes(y = HAP)) +
geom_point(aes(x = len+50000), y = -0.5, color = "white") +
geom_point(aes(x = len+50000), y = 1.5, color = "white") +
geom_point(x = -50000, y = -0.5, color = "white") +
geom_point(x = -50000, y = 1.5, color = "white") +
ggchicklet:::geom_rrect(data = chrlen_melt, aes(xmax = len, fill = HAP), xmin = 1, ymin = 0, ymax = 1, r = unit(0.3, 'npc')) +
geom_segment(aes(x = start, xend = end, color = REFHAP, group = HAP), y = 0.5, yend = 0.5, linewidth = 3.7, key_glyph = "pointrange") +
ggchicklet:::geom_rrect(data= chrlen_melt, aes(xmax = len+50000), xmin = -49999, ymin = -0.1, ymax = 1.1, r = unit(0.3, 'npc'), color = "white", fill = NA, size = 0.35) +
facet_grid(HAP ~ CHROM, labeller = labeller(CHROM = chr_labels), scales = "free_x", space = "free_x", switch = "y", margins = FALSE) +
scale_x_continuous(expand = c(0.01,0.01)) +
scale_y_discrete(limits=rev, expand = c(0.01,0.01)) +
scale_color_manual(breaks = c("hap3","hap4","hap25","hap26","hap5","hap7","hap8",
"hap27","hap28","hap29","hap30","hap31","hap32","hap14","hap1","hap2","hap13",
"hap11","hap15","hap16","hap17","hap18","hap19","hap20","hap6","hap10","hap12","hap23","hap9"),
values = c("#FA0348","#C581FC","grey20","#FA8203","#5EE3EF","grey20","grey20",
"grey20","grey20","grey20","grey20","grey20","grey20","#006023","#FF00F7","#0056FF","#FFCD97",
"#DDB8FF","#CFFFB8","#45C48C","#AEB431","#6BA9B4","grey20","grey20","grey20","grey20","grey20","grey20","grey20"),
name = "Color key", drop = TRUE, limits = c("hap3","hap4","hap26","hap5","hap14","hap1","hap2","hap13","hap11","hap15","hap16","hap17","hap18")) +
scale_fill_manual(breaks = c("hap3","hap4","hap25","hap26","hap5","hap7","hap8",
"hap27","hap28","hap29","hap30","hap31","hap32","hap14","hap1","hap2","hap13",
"hap11","hap15","hap16","hap17","hap18","hap19","hap20","hap6","hap10","hap12","hap23","hap9"),
values = c("#FA0348","#C581FC","grey20","#FA8203","#5EE3EF","grey20","grey20",
"grey20","grey20","grey20","grey20","grey20","grey20","#006023","#FF00F7","#0056FF","#FFCD97",
"#DDB8FF","#CFFFB8","#45C48C","#AEB431","#6BA9B4","grey20","grey20","grey20","grey20","grey20","grey20","grey20"),
name = "Color key", drop = TRUE, guide = "none") +
coord_cartesian(ylim = c(-0.6,1.6)) +
labs(x = NULL, y = NULL) +
theme(panel.background = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
strip.text.y.left = element_text(angle = 0, size = 10, hjust = 1),
strip.text.x.top = element_text(size = 10, vjust = 1, hjust = 0.5, margin = margin(t = 1, b = 0, l = 0, r = 0)),
strip.background.y = element_blank(),
axis.text.x = element_blank(),
legend.text = element_text(size = 8),
legend.title = element_blank(),
legend.key = element_blank(),
legend.key.size = unit(c(0.1), units = "in"),
plot.margin = unit(c(0,0,1.1,0), units = "lines"),
panel.spacing = unit(0, units = "lines"),
legend.position = c(-0.085,-0.01),
legend.background = element_blank(),
legend.justification = "left",
strip.background.x = element_blank(),
axis.ticks.x = element_blank()) +
guides(color = guide_legend(nrow = 1, override.aes = list(size = 1, fill = NA, linetype = 0)))
ggsave("Supplemental_figure10_pangenome_blocks.tiff", plot, device = "tiff", width = 7, height = 9, units = "in", dpi = 600)
