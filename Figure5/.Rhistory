geom_segment(data = subset(hapB_final, Allele == "2" & genotype == "0"), aes(x = POS, xend = POS, color = genotype), y = 0, yend = 0.3, lwd = 0.3, alpha = 0) +
geom_segment(data = subset(hapB_final, Allele == "2" & genotype != "0"), aes(x = POS, xend = POS, color = genotype), y = 0, yend = 0.3, lwd = 0.3) +
scale_color_manual(breaks = c(".","0","1","2","3","4","5"), values = c("white","black","yellow","red","skyblue","orange","purple"), labels = c("Missing", "Ref", "Alt 1", "Alt 2", "Alt 3", "Alt 4", "Alt 5"), name = "Genotype") +
labs(x = expression(paste("SNPs on ", italic("bW2bE2"), sep = "")), y = NULL) +
scale_x_continuous(labels = function(x) x-5295262, limits = c(5295260,5298876)) +
scale_y_continuous(limits = c(-0.4, 0.4)) +
facet_grid(rows = vars(Sample), switch = "y", margins = FALSE) +
theme(panel.background = element_blank(),
strip.text.y.left = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.ticks.x = element_blank(),
axis.text.x = element_blank(),
plot.margin = margin(0.1,0,0.1,0),
legend.margin = margin(0,0,0,0.1),
legend.key = element_rect(fill = "black"),
legend.text = element_text(size = 8))
combo <- ggarrange(hapA, hapB, ncol = 2, nrow = 1)
ggsave("C:/Users/HEN294/OneDrive - CSIRO/Documents/Research/Publication_manuscripts/Australia_hybrids_manuscript/Figure_construction_files/Supplemental_figure7/Figure_S7_HD_locus_snps.tiff",
combo, device = "tiff", width = 7.5, height = 12, units = "in", dpi = 600)
hapA <- ggplot(data = hapA_final) +
geom_segment(x = 4480820, xend = 4484472, y = 0, yend = 0, lwd = 1) +
geom_rect(xmin = 4480820, xmax = 4482137, ymin = -0.3, ymax = 0.3, fill = "black", color = "black", lwd = 1) +
geom_rect(xmin = 4482200, xmax = 4482612, ymin = -0.3, ymax = 0.3, fill = "black", color = "black", lwd = 1) +
geom_rect(xmin = 4483196, xmax = 4483834, ymin = -0.3, ymax = 0.3, fill = "black", color = "black", lwd = 1) +
geom_rect(xmin = 4483916, xmax = 4484047, ymin = -0.3, ymax = 0.3, fill = "black", color = "black", lwd = 1) +
geom_rect(xmin = 4484118, xmax = 4484472, ymin = -0.3, ymax = 0.3, fill = "black", color = "black", lwd = 1) +
geom_segment(data = subset(hapA_final, Allele == "1" & genotype == "0"), aes(x = POS, xend = POS, color = genotype), y = -0.3, yend = 0, lwd = 0.3, alpha = 0) +
geom_segment(data = subset(hapA_final, Allele == "1" & genotype != "0"), aes(x = POS, xend = POS, color = genotype), y = -0.3, yend = 0, lwd = 0.3) +
geom_segment(data = subset(hapA_final, Allele == "2" & genotype == "0"), aes(x = POS, xend = POS, color = genotype), y = 0, yend = 0.3, lwd = 0.3, alpha = 0) +
geom_segment(data = subset(hapA_final, Allele == "2" & genotype != "0"), aes(x = POS, xend = POS, color = genotype), y = 0, yend = 0.3, lwd = 0.3) +
scale_color_manual(breaks = c(".","0","1","2","3","4","5"), values = c("white","black","yellow","red","skyblue","orange","purple"), labels = c("Missing", "Ref", "Alt 1", "Alt 2", "Alt 3", "Alt 4", "Alt 5")) +
scale_x_continuous(labels = function(x) x-4480820, limits = c(4480818, 4484474)) +
scale_y_continuous(limits = c(-0.4,0.4)) +
labs(x = expression(paste("SNPs on ", italic("bW1bE1"), sep = "")), y = NULL) +
facet_grid(rows = vars(Sample), switch = "y", margins = FALSE) +
theme(panel.background = element_blank(),
strip.text.y.left = element_text(angle = 0, size = 8, hjust = 1, vjust = 0.5),
strip.background = element_blank(),
legend.position = "none",
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.ticks.x = element_blank(),
axis.text.x = element_blank(),
plot.margin = margin(0.1,0,0.1,0))
hapB <- ggplot(data = hapB_final) +
geom_segment(x = 5295262, xend = 5298874, y = 0, yend = 0, lwd = 1) +
geom_rect(xmin = 5295262, xmax = 5296585, ymin = -0.3, ymax = 0.3, fill = "black", color = "black", lwd = 1) +
geom_rect(xmin = 5296644, xmax = 5297050, ymin = -0.3, ymax = 0.3, fill = "black", color = "black", lwd = 1) +
geom_rect(xmin = 5297604, xmax = 5298236, ymin = -0.3, ymax = 0.3, fill = "black", color = "black", lwd = 1) +
geom_rect(xmin = 5298318, xmax = 5298449, ymin = -0.3, ymax = 0.3, fill = "black", color = "black", lwd = 1) +
geom_rect(xmin = 5298521, xmax = 5298874, ymin = -0.3, ymax = 0.3, fill = "black", color = "black", lwd = 1) +
geom_segment(data = subset(hapB_final, Allele == "1" & genotype == "0"), aes(x = POS, xend = POS, color = genotype), y = -0.3, yend = 0, lwd = 0.3, alpha = 0) +
geom_segment(data = subset(hapB_final, Allele == "1" & genotype != "0"), aes(x = POS, xend = POS, color = genotype), y = -0.3, yend = 0, lwd = 0.3) +
geom_segment(data = subset(hapB_final, Allele == "2" & genotype == "0"), aes(x = POS, xend = POS, color = genotype), y = 0, yend = 0.3, lwd = 0.3, alpha = 0) +
geom_segment(data = subset(hapB_final, Allele == "2" & genotype != "0"), aes(x = POS, xend = POS, color = genotype), y = 0, yend = 0.3, lwd = 0.3) +
scale_color_manual(breaks = c(".","0","1","2","3","4","5"), values = c("white","black","yellow","red","skyblue","orange","purple"), labels = c("Missing", "Ref", "Alt 1", "Alt 2", "Alt 3", "Alt 4", "Alt 5"), name = "Genotype") +
labs(x = expression(paste("SNPs on ", italic("bW2bE2"), sep = "")), y = NULL) +
scale_x_continuous(labels = function(x) x-5295262, limits = c(5295260,5298876)) +
scale_y_continuous(limits = c(-0.4, 0.4)) +
facet_grid(rows = vars(Sample), switch = "y", margins = FALSE) +
theme(panel.background = element_blank(),
strip.text.y.left = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.ticks.x = element_blank(),
axis.text.x = element_blank(),
plot.margin = margin(0.1,0,0.1,0),
legend.margin = margin(0,0,0,0.1),
legend.key = element_rect(fill = "black"),
legend.text = element_text(size = 8))
combo <- ggarrange(hapA, hapB, ncol = 2, nrow = 1)
hapB <- ggplot(data = hapB_final) +
geom_segment(x = 5295262, xend = 5298874, y = 0, yend = 0, lwd = 1) +
geom_rect(xmin = 5295262, xmax = 5296585, ymin = -0.3, ymax = 0.3, fill = "black", color = "black", lwd = 1) +
geom_rect(xmin = 5296644, xmax = 5297050, ymin = -0.3, ymax = 0.3, fill = "black", color = "black", lwd = 1) +
geom_rect(xmin = 5297604, xmax = 5298236, ymin = -0.3, ymax = 0.3, fill = "black", color = "black", lwd = 1) +
geom_rect(xmin = 5298318, xmax = 5298449, ymin = -0.3, ymax = 0.3, fill = "black", color = "black", lwd = 1) +
geom_rect(xmin = 5298521, xmax = 5298874, ymin = -0.3, ymax = 0.3, fill = "black", color = "black", lwd = 1) +
geom_segment(data = subset(hapB_final, Allele == "1" & genotype == "0"), aes(x = POS, xend = POS, color = genotype), y = -0.3, yend = 0, lwd = 0.3, alpha = 0) +
geom_segment(data = subset(hapB_final, Allele == "1" & genotype != "0"), aes(x = POS, xend = POS, color = genotype), y = -0.3, yend = 0, lwd = 0.3) +
geom_segment(data = subset(hapB_final, Allele == "2" & genotype == "0"), aes(x = POS, xend = POS, color = genotype), y = 0, yend = 0.3, lwd = 0.3, alpha = 0) +
geom_segment(data = subset(hapB_final, Allele == "2" & genotype != "0"), aes(x = POS, xend = POS, color = genotype), y = 0, yend = 0.3, lwd = 0.3) +
scale_color_manual(breaks = c(".","0","1","2","3","4","5"), values = c("white","black","yellow","red","skyblue","orange","purple"), labels = c("Missing", "Ref", "Alt 1", "Alt 2", "Alt 3", "Alt 4", "Alt 5"), name = "Genotype") +
labs(x = expression(paste("SNPs on ", italic("bW2bE2"), sep = "")), y = NULL) +
scale_x_continuous(labels = function(x) x-5295262, limits = c(5295260,5298876)) +
scale_y_continuous(limits = c(-0.4, 0.4)) +
facet_grid(rows = vars(Sample), switch = "y", margins = FALSE) +
theme(panel.background = element_blank(),
strip.text.y.left = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.ticks.x = element_blank(),
axis.text.x = element_blank(),
legend.position = "none",
plot.margin = margin(0.1,0,0.1,0),
legend.margin = margin(0,0,0,0.1),
legend.key = element_rect(fill = "black"),
legend.text = element_text(size = 8))
combo <- ggarrange(hapA, hapB, ncol = 2, nrow = 1)
ggsave("C:/Users/HEN294/OneDrive - CSIRO/Documents/Research/Publication_manuscripts/Australia_hybrids_manuscript/Figure_construction_files/Supplemental_figure7/Figure_S7_HD_locus_snps.tiff",
combo, device = "tiff", width = 7.5, height = 12, units = "in", dpi = 600)
ggsave("C:/Users/HEN294/OneDrive - CSIRO/Documents/Research/Publication_manuscripts/Australia_hybrids_manuscript/Figure_construction_files/Supplemental_figure7/Figure_S7_HD_locus_snps.tiff",
combo, device = "tiff", width = 7.5, height = 10, units = "in", dpi = 600)
hapA <- ggplot(data = hapA_final) +
geom_segment(x = 4480820, xend = 4484472, y = 0, yend = 0, lwd = 1) +
geom_rect(xmin = 4480820, xmax = 4482137, ymin = -0.3, ymax = 0.3, fill = "black", color = "black", lwd = 1) +
geom_rect(xmin = 4482200, xmax = 4482612, ymin = -0.3, ymax = 0.3, fill = "black", color = "black", lwd = 1) +
geom_rect(xmin = 4483196, xmax = 4483834, ymin = -0.3, ymax = 0.3, fill = "black", color = "black", lwd = 1) +
geom_rect(xmin = 4483916, xmax = 4484047, ymin = -0.3, ymax = 0.3, fill = "black", color = "black", lwd = 1) +
geom_rect(xmin = 4484118, xmax = 4484472, ymin = -0.3, ymax = 0.3, fill = "black", color = "black", lwd = 1) +
geom_segment(data = subset(hapA_final, Allele == "1" & genotype == "0"), aes(x = POS, xend = POS, color = genotype), y = -0.3, yend = 0, lwd = 0.3, alpha = 0) +
geom_segment(data = subset(hapA_final, Allele == "1" & genotype != "0"), aes(x = POS, xend = POS, color = genotype), y = -0.3, yend = 0, lwd = 0.3) +
geom_segment(data = subset(hapA_final, Allele == "2" & genotype == "0"), aes(x = POS, xend = POS, color = genotype), y = 0, yend = 0.3, lwd = 0.3, alpha = 0) +
geom_segment(data = subset(hapA_final, Allele == "2" & genotype != "0"), aes(x = POS, xend = POS, color = genotype), y = 0, yend = 0.3, lwd = 0.3) +
scale_color_manual(breaks = c(".","0","1","2","3","4","5"), values = c("white","black","yellow","red","skyblue","orange","purple"), labels = c("Missing", "Ref", "Alt 1", "Alt 2", "Alt 3", "Alt 4", "Alt 5")) +
scale_x_continuous(labels = function(x) x-4480820, limits = c(4480818, 4484474), expand = c(0.1,0.1)) +
scale_y_continuous(limits = c(-0.4,0.4), expand = c(0.1, 0.1)) +
labs(x = expression(paste("SNPs on ", italic("bW1bE1"), sep = "")), y = NULL) +
facet_grid(rows = vars(Sample), switch = "y", margins = FALSE) +
theme(panel.background = element_blank(),
strip.text.y.left = element_text(angle = 0, size = 10, hjust = 1, vjust = 0.5),
strip.background = element_blank(),
legend.position = "none",
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.ticks.x = element_blank(),
axis.text.x = element_blank(),
plot.margin = margin(0.1,0,0.1,0))
hapB <- ggplot(data = hapB_final) +
geom_segment(x = 5295262, xend = 5298874, y = 0, yend = 0, lwd = 1) +
geom_rect(xmin = 5295262, xmax = 5296585, ymin = -0.3, ymax = 0.3, fill = "black", color = "black", lwd = 1) +
geom_rect(xmin = 5296644, xmax = 5297050, ymin = -0.3, ymax = 0.3, fill = "black", color = "black", lwd = 1) +
geom_rect(xmin = 5297604, xmax = 5298236, ymin = -0.3, ymax = 0.3, fill = "black", color = "black", lwd = 1) +
geom_rect(xmin = 5298318, xmax = 5298449, ymin = -0.3, ymax = 0.3, fill = "black", color = "black", lwd = 1) +
geom_rect(xmin = 5298521, xmax = 5298874, ymin = -0.3, ymax = 0.3, fill = "black", color = "black", lwd = 1) +
geom_segment(data = subset(hapB_final, Allele == "1" & genotype == "0"), aes(x = POS, xend = POS, color = genotype), y = -0.3, yend = 0, lwd = 0.3, alpha = 0) +
geom_segment(data = subset(hapB_final, Allele == "1" & genotype != "0"), aes(x = POS, xend = POS, color = genotype), y = -0.3, yend = 0, lwd = 0.3) +
geom_segment(data = subset(hapB_final, Allele == "2" & genotype == "0"), aes(x = POS, xend = POS, color = genotype), y = 0, yend = 0.3, lwd = 0.3, alpha = 0) +
geom_segment(data = subset(hapB_final, Allele == "2" & genotype != "0"), aes(x = POS, xend = POS, color = genotype), y = 0, yend = 0.3, lwd = 0.3) +
scale_color_manual(breaks = c(".","0","1","2","3","4","5"), values = c("white","black","yellow","red","skyblue","orange","purple"), labels = c("Missing", "Ref", "Alt 1", "Alt 2", "Alt 3", "Alt 4", "Alt 5"), name = "Genotype") +
labs(x = expression(paste("SNPs on ", italic("bW2bE2"), sep = "")), y = NULL) +
scale_x_continuous(labels = function(x) x-5295262, limits = c(5295260,5298876), expand = c(0.1,0.1)) +
scale_y_continuous(limits = c(-0.4, 0.4), expand = c(0.1,0.1)) +
facet_grid(rows = vars(Sample), switch = "y", margins = FALSE) +
theme(panel.background = element_blank(),
strip.text.y.left = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.ticks.x = element_blank(),
axis.text.x = element_blank(),
legend.position = "none",
plot.margin = margin(0.1,0,0.1,0),
legend.margin = margin(0,0,0,0.1),
legend.key = element_rect(fill = "black"),
legend.text = element_text(size = 8))
combo <- ggarrange(hapA, hapB, ncol = 2, nrow = 1)
ggsave("C:/Users/HEN294/OneDrive - CSIRO/Documents/Research/Publication_manuscripts/Australia_hybrids_manuscript/Figure_construction_files/Supplemental_figure7/Figure_S7_HD_locus_snps.tiff",
combo, device = "tiff", width = 7.5, height = 10, units = "in", dpi = 600)
hapA <- ggplot(data = hapA_final) +
geom_segment(x = 4480820, xend = 4484472, y = 0, yend = 0, lwd = 1) +
geom_rect(xmin = 4480820, xmax = 4482137, ymin = -0.3, ymax = 0.3, fill = "black", color = "black", lwd = 1) +
geom_rect(xmin = 4482200, xmax = 4482612, ymin = -0.3, ymax = 0.3, fill = "black", color = "black", lwd = 1) +
geom_rect(xmin = 4483196, xmax = 4483834, ymin = -0.3, ymax = 0.3, fill = "black", color = "black", lwd = 1) +
geom_rect(xmin = 4483916, xmax = 4484047, ymin = -0.3, ymax = 0.3, fill = "black", color = "black", lwd = 1) +
geom_rect(xmin = 4484118, xmax = 4484472, ymin = -0.3, ymax = 0.3, fill = "black", color = "black", lwd = 1) +
geom_segment(data = subset(hapA_final, Allele == "1" & genotype == "0"), aes(x = POS, xend = POS, color = genotype), y = -0.3, yend = 0, lwd = 0.3, alpha = 0) +
geom_segment(data = subset(hapA_final, Allele == "1" & genotype != "0"), aes(x = POS, xend = POS, color = genotype), y = -0.3, yend = 0, lwd = 0.3) +
geom_segment(data = subset(hapA_final, Allele == "2" & genotype == "0"), aes(x = POS, xend = POS, color = genotype), y = 0, yend = 0.3, lwd = 0.3, alpha = 0) +
geom_segment(data = subset(hapA_final, Allele == "2" & genotype != "0"), aes(x = POS, xend = POS, color = genotype), y = 0, yend = 0.3, lwd = 0.3) +
scale_color_manual(breaks = c(".","0","1","2","3","4","5"), values = c("white","black","yellow","red","skyblue","orange","purple"), labels = c("Missing", "Ref", "Alt 1", "Alt 2", "Alt 3", "Alt 4", "Alt 5")) +
scale_x_continuous(labels = function(x) x-4480820, limits = c(4480818, 4484474)) +
scale_y_continuous(limits = c(-0.4,0.4)) +
labs(x = expression(paste("SNPs on ", italic("bW1bE1"), sep = "")), y = NULL) +
facet_grid(rows = vars(Sample), switch = "y", margins = FALSE) +
theme(panel.background = element_blank(),
strip.text.y.left = element_text(angle = 0, size = 10, hjust = 1, vjust = 0.5, margin = margin(0,0,0,0)),
strip.background = element_blank(),
legend.position = "none",
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.ticks.x = element_blank(),
axis.text.x = element_blank(),
plot.margin = margin(0.1,0,0.1,0))
hapB <- ggplot(data = hapB_final) +
geom_segment(x = 5295262, xend = 5298874, y = 0, yend = 0, lwd = 1) +
geom_rect(xmin = 5295262, xmax = 5296585, ymin = -0.3, ymax = 0.3, fill = "black", color = "black", lwd = 1) +
geom_rect(xmin = 5296644, xmax = 5297050, ymin = -0.3, ymax = 0.3, fill = "black", color = "black", lwd = 1) +
geom_rect(xmin = 5297604, xmax = 5298236, ymin = -0.3, ymax = 0.3, fill = "black", color = "black", lwd = 1) +
geom_rect(xmin = 5298318, xmax = 5298449, ymin = -0.3, ymax = 0.3, fill = "black", color = "black", lwd = 1) +
geom_rect(xmin = 5298521, xmax = 5298874, ymin = -0.3, ymax = 0.3, fill = "black", color = "black", lwd = 1) +
geom_segment(data = subset(hapB_final, Allele == "1" & genotype == "0"), aes(x = POS, xend = POS, color = genotype), y = -0.3, yend = 0, lwd = 0.3, alpha = 0) +
geom_segment(data = subset(hapB_final, Allele == "1" & genotype != "0"), aes(x = POS, xend = POS, color = genotype), y = -0.3, yend = 0, lwd = 0.3) +
geom_segment(data = subset(hapB_final, Allele == "2" & genotype == "0"), aes(x = POS, xend = POS, color = genotype), y = 0, yend = 0.3, lwd = 0.3, alpha = 0) +
geom_segment(data = subset(hapB_final, Allele == "2" & genotype != "0"), aes(x = POS, xend = POS, color = genotype), y = 0, yend = 0.3, lwd = 0.3) +
scale_color_manual(breaks = c(".","0","1","2","3","4","5"), values = c("white","black","yellow","red","skyblue","orange","purple"), labels = c("Missing", "Ref", "Alt 1", "Alt 2", "Alt 3", "Alt 4", "Alt 5"), name = "Genotype") +
labs(x = expression(paste("SNPs on ", italic("bW2bE2"), sep = "")), y = NULL) +
scale_x_continuous(labels = function(x) x-5295262, limits = c(5295260,5298876)) +
scale_y_continuous(limits = c(-0.4, 0.4)) +
facet_grid(rows = vars(Sample), switch = "y", margins = FALSE) +
theme(panel.background = element_blank(),
strip.text.y.left = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.ticks.x = element_blank(),
axis.text.x = element_blank(),
legend.position = "none",
plot.margin = margin(0.1,0,0.1,0),
legend.margin = margin(0,0,0,0.1),
legend.key = element_rect(fill = "black"),
legend.text = element_text(size = 8))
combo <- ggarrange(hapA, hapB, ncol = 2, nrow = 1)
ggsave("C:/Users/HEN294/OneDrive - CSIRO/Documents/Research/Publication_manuscripts/Australia_hybrids_manuscript/Figure_construction_files/Supplemental_figure7/Figure_S7_HD_locus_snps.tiff",
combo, device = "tiff", width = 7.5, height = 10, units = "in", dpi = 600)
ggsave("C:/Users/HEN294/OneDrive - CSIRO/Documents/Research/Publication_manuscripts/Australia_hybrids_manuscript/Figure_construction_files/Supplemental_figure7/Figure_S7_HD_locus_snps.tiff",
combo, device = "tiff", width = 7, height = 10, units = "in", dpi = 600)
combo <- ggarrange(hapA, hapB, ncol = 2, nrow = 1, widths = c(1.1,1))
ggsave("C:/Users/HEN294/OneDrive - CSIRO/Documents/Research/Publication_manuscripts/Australia_hybrids_manuscript/Figure_construction_files/Supplemental_figure7/Figure_S7_HD_locus_snps.tiff",
combo, device = "tiff", width = 7, height = 10, units = "in", dpi = 600)
combo <- ggarrange(hapA, hapB, ncol = 2, nrow = 1, widths = c(1.2,1))
ggsave("C:/Users/HEN294/OneDrive - CSIRO/Documents/Research/Publication_manuscripts/Australia_hybrids_manuscript/Figure_construction_files/Supplemental_figure7/Figure_S7_HD_locus_snps.tiff",
combo, device = "tiff", width = 7, height = 10, units = "in", dpi = 600)
combo <- ggarrange(hapA, hapB, ncol = 2, nrow = 1, widths = c(1.3,1))
ggsave("C:/Users/HEN294/OneDrive - CSIRO/Documents/Research/Publication_manuscripts/Australia_hybrids_manuscript/Figure_construction_files/Supplemental_figure7/Figure_S7_HD_locus_snps.tiff",
combo, device = "tiff", width = 7, height = 10, units = "in", dpi = 600)
ggsave("C:/Users/HEN294/OneDrive - CSIRO/Documents/Research/Publication_manuscripts/Australia_hybrids_manuscript/Figure_construction_files/Supplemental_figure7/Figure_S7_HD_locus_snps.tiff",
combo, device = "tiff", width = 7, height = 9.9, units = "in", dpi = 600)
chisq.test(x = c(0.5, 0.5), p = c(0,1))
chisq.test(x = c(0, 1), p = c(0.5,0.5))
chisq.test(x = c(0,1))
chisq.test(x = c(0,127))
chisq.test(x = c(0,127), p = c(0.5,0.5))
#chisq.test(x = c(0, 1), p = c(0.5,0.5))
result <- chisq.test(x = c(0,127), p = c(0.5,0.5))
options(scipen = 999)
#chisq.test(x = c(0, 1), p = c(0.5,0.5))
result <- chisq.test(x = c(0,127), p = c(0.5,0.5))
options(scipen = 1)
#chisq.test(x = c(0, 1), p = c(0.5,0.5))
result <- chisq.test(x = c(0,127), p = c(0.5,0.5))
install.packages("polysat")
library(polysat)
library("HardyWeinberg")
install.packages("HardyWeinberg")
chisq.test(x = c(0,88), p = c(0.118866, 0.881134))
chisq.test(x = c(0,88), p = c(0.5, 0.5))
aloc <- chisq.test(x = c(0,88), p = c(0.5, 0.5))
options(scipen = 999)
library(ggplot2)
library(dplyr)
library(reshape2)
library(purrr)
library(ggchicklet)
## Figure 5 & Supplementa
chr_labels <- c(
chr1 = "1",
chr2 = "2",
chr3 = "3",
chr4 = "4",
chr5 = "5",
chr6 = "6",
chr7 = "7",
chr8 = "8",
chr9 = "9",
chr10 = "10",
chr11 = "11",
chr12 = "12",
chr13 = "13",
chr14 = "14",
chr15 = "15",
chr16 = "16",
chr17 = "17",
chr18 = "18"
)
haps_chrs <- read.delim("Figure3_chromosome_lengths.txt", sep = "\t", header = TRUE)
colnames(haps_chrs) <- c("HAP","chr1","chr2","chr3","chr4","chr5","chr6","chr7","chr8","chr9","chr10","chr11","chr12","chr13","chr14","chr15","chr16","chr17","chr18")
chrlen_melt <-melt(haps_chrs, id.vars = "HAP", variable.name = "CHROM", value.name = "len")
chrlen_melt$CHROM <- factor(chrlen_melt$CHROM, levels = c("chr1","chr2","chr3","chr4","chr5","chr6","chr7","chr8","chr9","chr10","chr11","chr12","chr13","chr14","chr15","chr16","chr17","chr18"))
merged_intervals <- read.delim("all_intervals.txt", sep = "\t", header = FALSE)
colnames(merged_intervals) <- c("CHROM","start","end","HAP","dens","REFHAP")
merged_intervals <- merged_intervals[,c(4,1,2,3,6)]
final_joined <- full_join(merged_intervals, chrlen_melt, by = c("HAP","CHROM"))
final_joined$HAP <- factor(final_joined$HAP)
keepme <- final_joined
keepme <- subset(keepme, !(HAP %in% c("hap21","hap22","hap24")))
keepme <- subset(keepme, !(REFHAP %in% c("hap21","hap22","hap24")))
setwd("C:/Users/HEN294/OneDrive - CSIRO/Documents/GitHub/Pca_pangenome/Figure5")
chr_labels <- c(
chr1 = "1",
chr2 = "2",
chr3 = "3",
chr4 = "4",
chr5 = "5",
chr6 = "6",
chr7 = "7",
chr8 = "8",
chr9 = "9",
chr10 = "10",
chr11 = "11",
chr12 = "12",
chr13 = "13",
chr14 = "14",
chr15 = "15",
chr16 = "16",
chr17 = "17",
chr18 = "18"
)
haps_chrs <- read.delim("Figure3_chromosome_lengths.txt", sep = "\t", header = TRUE)
colnames(haps_chrs) <- c("HAP","chr1","chr2","chr3","chr4","chr5","chr6","chr7","chr8","chr9","chr10","chr11","chr12","chr13","chr14","chr15","chr16","chr17","chr18")
chrlen_melt <-melt(haps_chrs, id.vars = "HAP", variable.name = "CHROM", value.name = "len")
chrlen_melt$CHROM <- factor(chrlen_melt$CHROM, levels = c("chr1","chr2","chr3","chr4","chr5","chr6","chr7","chr8","chr9","chr10","chr11","chr12","chr13","chr14","chr15","chr16","chr17","chr18"))
merged_intervals <- read.delim("all_intervals.txt", sep = "\t", header = FALSE)
colnames(merged_intervals) <- c("CHROM","start","end","HAP","dens","REFHAP")
merged_intervals <- merged_intervals[,c(4,1,2,3,6)]
final_joined <- full_join(merged_intervals, chrlen_melt, by = c("HAP","CHROM"))
final_joined$HAP <- factor(final_joined$HAP)
keepme <- final_joined
keepme <- subset(keepme, !(HAP %in% c("hap21","hap22","hap24")))
keepme <- subset(keepme, !(REFHAP %in% c("hap21","hap22","hap24")))
keepme$REFHAP <- factor(keepme$REFHAP)
keepme$HAP <- factor(keepme$HAP, levels = c("hap3","hap4","hap25","hap5","hap26","hap7","hap8","hap27","hap28","hap29","hap30","hap31","hap32","hap14","hap1","hap2","hap10","hap11","hap12","hap13","hap15","hap16","hap17","hap18","hap19","hap20","hap6","hap23","hap9"))
keepme$CHROM <- factor(keepme$CHROM, levels = c("chr1","chr2","chr3","chr4","chr5","chr6","chr7","chr8","chr9","chr10","chr11","chr12","chr13","chr14","chr15","chr16","chr17","chr18"))
chrlen_melt <- subset(chrlen_melt, !(HAP %in% c("hap21","hap22","hap24")))
chrlen_melt$HAP <- factor(chrlen_melt$HAP, levels = c("hap3","hap4","hap25","hap5","hap26","hap7","hap8","hap27","hap28","hap29","hap30","hap31","hap32","hap14","hap1","hap2","hap10","hap11","hap12","hap13","hap15","hap16","hap17","hap18","hap19","hap20","hap6","hap23","hap9"))
fig5a_chr_sub <- subset(chrlen_melt, HAP %in% c("hap1","hap2","hap11","hap12","hap17","hap18"))
fig5a_sub <- subset(keepme, HAP %in% c("hap1","hap2","hap11","hap12","hap17","hap18"))
fig5a_sub <- subset(fig5a_sub, REFHAP %in% c("hap1","hap2","hap11","hap12"))
plot <- ggplot(data = fig5a_sub, aes(y = HAP)) +
geom_point(aes(x = len+15000), y = -0.5, color = "white") +
geom_point(aes(x = len+15000), y = 1.5, color = "white") +
geom_point(x = -15000, y = -0.5, color = "white") +
geom_point(x = -15000, y = 1.5, color = "white") +
ggchicklet:::geom_rrect(data = fig5a_chr_sub, aes(xmax = len, fill = HAP), xmin = 1, ymin = 0, ymax = 1, r = unit(0.1, 'npc')) +
geom_segment(data = na.omit(fig5a_sub), aes(x = start, xend = end, color = REFHAP, group = HAP), y = 0.5, yend = 0.5, linewidth = 5.7, key_glyph = "pointrange") +
ggchicklet:::geom_rrect(data= fig5a_chr_sub, aes(xmax = len+15000), xmin = -14999, ymin = -0.01, ymax = 1.01, r = unit(0.1, 'npc'), color = "black", fill = NA, size = 0.3) +
facet_grid(HAP ~ CHROM, labeller = labeller(CHROM = chr_labels), scales = "fixed", space = "free_x", switch = "y", margins = FALSE) +
scale_x_continuous(expand = c(0.12,0.12)) +
scale_y_discrete(limits=rev, expand = c(0.01,0.01)) +
scale_color_manual(breaks = c("hap1","hap2","hap11","hap12","hap17","hap18"),
values = c("#FF00F7","#00E095","#DDB8FF","#CFFFB8","#AEB431","#6BA9B4"), name = "Color key", drop = TRUE, limits = c("hap1","hap2","hap11","hap12","hap17","hap18")) +
scale_fill_manual(breaks = c("hap1","hap2","hap11","hap12","hap17","hap18"),
values = c("#FF00F7","#00E095","#DDB8FF","#CFFFB8","#AEB431","#6BA9B4"), name = "Color key", drop = TRUE, guide = "none") +
labs(x = NULL, y = NULL) +
coord_cartesian(ylim = c(-0.6,1.6)) +
theme(panel.background = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
strip.text.y.left = element_text(angle = 0, size = 10, hjust = 1),
strip.text.x.top = element_text(size = 10, vjust = 1, hjust = 0.5, margin = margin(t = 1, b = 0, l = 0, r = 0)),
strip.background.y = element_blank(),
axis.text.x = element_blank(),
legend.text = element_text(size = 8),
legend.title = element_blank(),
legend.key = element_blank(),
legend.key.size = unit(c(0.1), units = "in"),
plot.margin = unit(c(0,0,1.1,0), units = "lines"),
panel.spacing = unit(0, units = "lines"),
legend.position = c(0,-0.01),
legend.background = element_blank(),
legend.justification = "left",
strip.background.x = element_blank(),
axis.ticks.x = element_blank()) +
guides(color = guide_legend(nrow = 1, override.aes = list(size = 1, fill = NA, linetype = 0)))
ggsave("Figure5_pangenome_blocks_100kb_panela.tiff", plot, device = "tiff", width = 7.5, height = 2.8, units = "in", dpi = 600)
plot <- ggplot(data = fig5a_sub, aes(y = HAP)) +
geom_point(aes(x = len+15000), y = -0.5, color = "white") +
geom_point(aes(x = len+15000), y = 1.5, color = "white") +
geom_point(x = -15000, y = -0.5, color = "white") +
geom_point(x = -15000, y = 1.5, color = "white") +
ggchicklet:::geom_rrect(data = fig5a_chr_sub, aes(xmax = len, fill = HAP), xmin = 1, ymin = 0, ymax = 1, r = unit(0.1, 'npc')) +
geom_segment(data = na.omit(fig5a_sub), aes(x = start, xend = end, color = REFHAP, group = HAP), y = 0.5, yend = 0.5, linewidth = 5.7, key_glyph = "pointrange") +
ggchicklet:::geom_rrect(data= fig5a_chr_sub, aes(xmax = len+15000), xmin = -14999, ymin = -0.01, ymax = 1.01, r = unit(0.1, 'npc'), color = "black", fill = NA, size = 0.3) +
facet_grid(HAP ~ CHROM, labeller = labeller(CHROM = chr_labels), scales = "fixed", space = "free_x", switch = "y", margins = FALSE) +
scale_x_continuous(expand = c(0.03,0.03)) +
scale_y_discrete(limits=rev, expand = c(0.01,0.01)) +
scale_color_manual(breaks = c("hap1","hap2","hap11","hap12","hap17","hap18"),
values = c("#FF00F7","#00E095","#DDB8FF","#CFFFB8","#AEB431","#6BA9B4"), name = "Color key", drop = TRUE, limits = c("hap1","hap2","hap11","hap12","hap17","hap18")) +
scale_fill_manual(breaks = c("hap1","hap2","hap11","hap12","hap17","hap18"),
values = c("#FF00F7","#00E095","#DDB8FF","#CFFFB8","#AEB431","#6BA9B4"), name = "Color key", drop = TRUE, guide = "none") +
labs(x = NULL, y = NULL) +
coord_cartesian(ylim = c(-0.6,1.6)) +
theme(panel.background = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
strip.text.y.left = element_text(angle = 0, size = 10, hjust = 1),
strip.text.x.top = element_text(size = 10, vjust = 1, hjust = 0.5, margin = margin(t = 1, b = 0, l = 0, r = 0)),
strip.background.y = element_blank(),
axis.text.x = element_blank(),
legend.text = element_text(size = 8),
legend.title = element_blank(),
legend.key = element_blank(),
legend.key.size = unit(c(0.1), units = "in"),
plot.margin = unit(c(0,0,1.1,0), units = "lines"),
panel.spacing = unit(0, units = "lines"),
legend.position = c(0,-0.01),
legend.background = element_blank(),
legend.justification = "left",
strip.background.x = element_blank(),
axis.ticks.x = element_blank()) +
guides(color = guide_legend(nrow = 1, override.aes = list(size = 1, fill = NA, linetype = 0)))
ggsave("Figure5_pangenome_blocks_100kb_panela.tiff", plot, device = "tiff", width = 7.5, height = 2.8, units = "in", dpi = 600)
plot <- ggplot(data = fig5a_sub, aes(y = HAP)) +
geom_point(aes(x = len+15000), y = -0.5, color = "white") +
geom_point(aes(x = len+15000), y = 1.5, color = "white") +
geom_point(x = -15000, y = -0.5, color = "white") +
geom_point(x = -15000, y = 1.5, color = "white") +
ggchicklet:::geom_rrect(data = fig5a_chr_sub, aes(xmax = len, fill = HAP), xmin = 1, ymin = 0, ymax = 1, r = unit(0.1, 'npc')) +
geom_segment(data = na.omit(fig5a_sub), aes(x = start, xend = end, color = REFHAP, group = HAP), y = 0.5, yend = 0.5, linewidth = 5.7, key_glyph = "pointrange") +
ggchicklet:::geom_rrect(data= fig5a_chr_sub, aes(xmax = len+15000), xmin = -14999, ymin = -0.01, ymax = 1.01, r = unit(0.1, 'npc'), color = "black", fill = NA, size = 0.3) +
facet_grid(HAP ~ CHROM, labeller = labeller(CHROM = chr_labels), scales = "free_x", space = "fixed", switch = "y", margins = FALSE) +
scale_x_continuous(expand = c(0.03,0.03)) +
scale_y_discrete(limits=rev, expand = c(0.01,0.01)) +
scale_color_manual(breaks = c("hap1","hap2","hap11","hap12","hap17","hap18"),
values = c("#FF00F7","#00E095","#DDB8FF","#CFFFB8","#AEB431","#6BA9B4"), name = "Color key", drop = TRUE, limits = c("hap1","hap2","hap11","hap12","hap17","hap18")) +
scale_fill_manual(breaks = c("hap1","hap2","hap11","hap12","hap17","hap18"),
values = c("#FF00F7","#00E095","#DDB8FF","#CFFFB8","#AEB431","#6BA9B4"), name = "Color key", drop = TRUE, guide = "none") +
labs(x = NULL, y = NULL) +
coord_cartesian(ylim = c(-0.6,1.6)) +
theme(panel.background = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
strip.text.y.left = element_text(angle = 0, size = 10, hjust = 1),
strip.text.x.top = element_text(size = 10, vjust = 1, hjust = 0.5, margin = margin(t = 1, b = 0, l = 0, r = 0)),
strip.background.y = element_blank(),
axis.text.x = element_blank(),
legend.text = element_text(size = 8),
legend.title = element_blank(),
legend.key = element_blank(),
legend.key.size = unit(c(0.1), units = "in"),
plot.margin = unit(c(0,0,1.1,0), units = "lines"),
panel.spacing = unit(0, units = "lines"),
legend.position = c(0,-0.01),
legend.background = element_blank(),
legend.justification = "left",
strip.background.x = element_blank(),
axis.ticks.x = element_blank()) +
guides(color = guide_legend(nrow = 1, override.aes = list(size = 1, fill = NA, linetype = 0)))
ggsave("Figure5_pangenome_blocks_100kb_panela.tiff", plot, device = "tiff", width = 7.5, height = 2.8, units = "in", dpi = 600)
plot <- ggplot(data = fig5a_sub, aes(y = HAP)) +
geom_point(aes(x = len+15000), y = -0.5, color = "white") +
geom_point(aes(x = len+15000), y = 1.5, color = "white") +
geom_point(x = -15000, y = -0.5, color = "white") +
geom_point(x = -15000, y = 1.5, color = "white") +
ggchicklet:::geom_rrect(data = fig5a_chr_sub, aes(xmax = len, fill = HAP), xmin = 1, ymin = 0, ymax = 1, r = unit(0.1, 'npc')) +
geom_segment(data = na.omit(fig5a_sub), aes(x = start, xend = end, color = REFHAP, group = HAP), y = 0.5, yend = 0.5, linewidth = 5.7, key_glyph = "pointrange") +
ggchicklet:::geom_rrect(data= fig5a_chr_sub, aes(xmax = len+15000), xmin = -14999, ymin = -0.01, ymax = 1.01, r = unit(0.1, 'npc'), color = "black", fill = NA, size = 0.3) +
facet_grid(HAP ~ CHROM, labeller = labeller(CHROM = chr_labels), scales = "free_x", space = "free_x", switch = "y", margins = FALSE) +
scale_x_continuous(expand = c(0.03,0.03)) +
scale_y_discrete(limits=rev, expand = c(0.01,0.01)) +
scale_color_manual(breaks = c("hap1","hap2","hap11","hap12","hap17","hap18"),
values = c("#FF00F7","#00E095","#DDB8FF","#CFFFB8","#AEB431","#6BA9B4"), name = "Color key", drop = TRUE, limits = c("hap1","hap2","hap11","hap12","hap17","hap18")) +
scale_fill_manual(breaks = c("hap1","hap2","hap11","hap12","hap17","hap18"),
values = c("#FF00F7","#00E095","#DDB8FF","#CFFFB8","#AEB431","#6BA9B4"), name = "Color key", drop = TRUE, guide = "none") +
labs(x = NULL, y = NULL) +
coord_cartesian(ylim = c(-0.6,1.6)) +
theme(panel.background = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
strip.text.y.left = element_text(angle = 0, size = 10, hjust = 1),
strip.text.x.top = element_text(size = 10, vjust = 1, hjust = 0.5, margin = margin(t = 1, b = 0, l = 0, r = 0)),
strip.background.y = element_blank(),
axis.text.x = element_blank(),
legend.text = element_text(size = 8),
legend.title = element_blank(),
legend.key = element_blank(),
legend.key.size = unit(c(0.1), units = "in"),
plot.margin = unit(c(0,0,1.1,0), units = "lines"),
panel.spacing = unit(0, units = "lines"),
legend.position = c(0,-0.01),
legend.background = element_blank(),
legend.justification = "left",
strip.background.x = element_blank(),
axis.ticks.x = element_blank()) +
guides(color = guide_legend(nrow = 1, override.aes = list(size = 1, fill = NA, linetype = 0)))
ggsave("Figure5_pangenome_blocks_100kb_panela.tiff", plot, device = "tiff", width = 7.5, height = 2.8, units = "in", dpi = 600)
plot <- ggplot(data = fig5a_sub, aes(y = HAP)) +
geom_point(aes(x = len+15000), y = -0.5, color = "white") +
geom_point(aes(x = len+15000), y = 1.5, color = "white") +
geom_point(x = -15000, y = -0.5, color = "white") +
geom_point(x = -15000, y = 1.5, color = "white") +
ggchicklet:::geom_rrect(data = fig5a_chr_sub, aes(xmax = len, fill = HAP), xmin = 1, ymin = 0, ymax = 1, r = unit(0.1, 'npc')) +
geom_segment(data = na.omit(fig5a_sub), aes(x = start, xend = end, color = REFHAP, group = HAP), y = 0.5, yend = 0.5, linewidth = 5.7, key_glyph = "pointrange") +
ggchicklet:::geom_rrect(data= fig5a_chr_sub, aes(xmax = len+15000), xmin = -14999, ymin = -0.01, ymax = 1.01, r = unit(0.1, 'npc'), color = "black", fill = NA, size = 0.3) +
facet_grid(HAP ~ CHROM, labeller = labeller(CHROM = chr_labels), scales = "free_x", space = "free_x", switch = "y", margins = FALSE) +
scale_x_continuous(expand = c(0.12,0.12)) +
scale_y_discrete(limits=rev, expand = c(0.01,0.01)) +
scale_color_manual(breaks = c("hap1","hap2","hap11","hap12","hap17","hap18"),
values = c("#FF00F7","#00E095","#DDB8FF","#CFFFB8","#AEB431","#6BA9B4"), name = "Color key", drop = TRUE, limits = c("hap1","hap2","hap11","hap12","hap17","hap18")) +
scale_fill_manual(breaks = c("hap1","hap2","hap11","hap12","hap17","hap18"),
values = c("#FF00F7","#00E095","#DDB8FF","#CFFFB8","#AEB431","#6BA9B4"), name = "Color key", drop = TRUE, guide = "none") +
labs(x = NULL, y = NULL) +
coord_cartesian(ylim = c(-0.6,1.6)) +
theme(panel.background = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
strip.text.y.left = element_text(angle = 0, size = 10, hjust = 1),
strip.text.x.top = element_text(size = 10, vjust = 1, hjust = 0.5, margin = margin(t = 1, b = 0, l = 0, r = 0)),
strip.background.y = element_blank(),
axis.text.x = element_blank(),
legend.text = element_text(size = 8),
legend.title = element_blank(),
legend.key = element_blank(),
legend.key.size = unit(c(0.1), units = "in"),
plot.margin = unit(c(0,0,1.1,0), units = "lines"),
panel.spacing = unit(0, units = "lines"),
legend.position = c(0,-0.01),
legend.background = element_blank(),
legend.justification = "left",
strip.background.x = element_blank(),
axis.ticks.x = element_blank()) +
guides(color = guide_legend(nrow = 1, override.aes = list(size = 1, fill = NA, linetype = 0)))
ggsave("Figure5_pangenome_blocks_100kb_panela.tiff", plot, device = "tiff", width = 7.5, height = 2.8, units = "in", dpi = 600)
